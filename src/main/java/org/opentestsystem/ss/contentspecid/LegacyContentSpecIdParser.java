package org.opentestsystem.ss.contentspecid;

import javax.annotation.Nonnull;

import static java.lang.String.format;
import static org.opentestsystem.ss.contentspecid.ContentSpecIdFormat.ELA_V1;
import static org.opentestsystem.ss.contentspecid.ContentSpecIdFormat.MATH_V4;
import static org.opentestsystem.ss.contentspecid.ContentSpecIdFormat.MATH_V5;
import static org.opentestsystem.ss.contentspecid.ContentSpecIdFormat.MATH_V6;

/**
 * Created by Greg Charles on 11/9/18.
 */
public class LegacyContentSpecIdParser extends ContentSpecIdParser {
    private static final String LEGACY_ELA_MARKER = "SBAC-ELA-v1:";
    private static final String LEGACY_MATH_MARKER = "SBAC-MA-v";

    public ContentSpecIdFormat getFormatType(@Nonnull final String input) throws IdParseException {
        String idString = cleanInput(input);

        if (idString.startsWith(LEGACY_ELA_MARKER)) {
            return ELA_V1;
        }

        if (idString.startsWith(LEGACY_MATH_MARKER)) {
            switch (idString.charAt(LEGACY_MATH_MARKER.length())) {
                case '4':
                    return MATH_V4;
                case '5':
                    return MATH_V5;
                case '6':
                    return MATH_V6;
            }
        }

        throw new IdParseException(ErrorSeverity.INVALID, format("Unknown ID format: '{%s}'.", idString));
    }

    public ContentSpecIdModel parse(String input) {
        return null;
    }
}
