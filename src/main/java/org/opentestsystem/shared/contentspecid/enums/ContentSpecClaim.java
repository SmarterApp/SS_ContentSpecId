package org.opentestsystem.shared.contentspecid.enums;

import static org.apache.commons.lang3.StringUtils.isBlank;

/**
 * Enum of Claim types for Content Spec ID
 */
public enum ContentSpecClaim {
    UNSPECIFIED(""),
    C1("1"),
    C2("2"),
    C3("3"),
    C4("4");

    private final String value;

    ContentSpecClaim(String value) {
        this.value = value;
    }

    public String getValue() {
        return value;
    }

    /**
     * Converts from a string to a ContentSpecClaim. Strings can any number in the range 1 to 4, or
     * any of these preceded by a "C". E.g., 1 or C1., HS or GHS. Case is ignored. Left and right whitespace
     * padding is also ignored.
     *
     * @param s the string to convert
     * @return the converted claim or UNSPECIFIED if the conversion fails.
     */
    public static ContentSpecClaim fromString(String s) {
        if (isBlank(s)) {
            return UNSPECIFIED;
        }

        String claimString = s.trim().toUpperCase();
        if (!claimString.startsWith("C")) {
            claimString = "C" + claimString;
        }

        try {
            return valueOf(claimString);
        } catch (IllegalArgumentException | NullPointerException e) {
            return UNSPECIFIED;
        }
    }
}
